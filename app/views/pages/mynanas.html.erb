<h1>My Nanas</h1>

<div>
  <h2>Friend requests</h2>
  <% @friends_requested.each do |friend_requested| %>
    <%= friend_requested.firstname  %>

      <%=link_to accept_friend_path(friend_requested.id), method: :patch do %>
        <i class="fas fa-check-circle"></i>
      <% end %>

      <%=link_to reject_friend_path(friend_requested.id), method: :patch do %>
        <i class="fas fa-times-circle"></i>
      <% end %>

  <% end %>
</div>

<div>
  <h2>My friends</h2>

  <% @friends.each do |friend|%>

    <%= friend.firstname %>
    <% if friend.is_favorited?(current_user) %>
            <%= link_to nana_unfriend_path(friend.id), method: :delete, remote: true  do %>
              <i class="fas fa-heart blue-heart" id=<%= friend.id%> onClick="reply_click(this.id)"></i>
            <% end %>
    <% else  %>
            <%= link_to nana_friend_path(friend.id), method: :post, remote: true do %>
            <i class="fas fa-heart" id=<%= friend.id%> onClick="reply_click(this.id)"></i>
            <% end %>
    <% end %>

  <% end %>
</div>

<script type="text/javascript">
  function reply_click(clicked_id) {
  const element = document.getElementById(clicked_id)
  const hrefString = element.parentElement.getAttribute('href');

    if (hrefString == `/nana_friend/${clicked_id}`) {
      const hrefStringNew = `/nana_unfriend/${clicked_id}`;
      element.parentElement.setAttribute('href', hrefStringNew);
      element.parentElement.setAttribute('data-method', 'delete');
      element.classList.remove("blue-heart");
    } else {
      const hrefStringNew = `/nana_friend/${clicked_id}`;
      element.parentElement.setAttribute('href', hrefStringNew);
      element.parentElement.setAttribute('data-method', 'post');
      element.classList.add("blue-heart");
    }
  };
</script>
